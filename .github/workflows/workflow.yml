name: BWM-XMD Quantum CI Pipeline

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        submodules: recursive

    - name: Setup CUDA Quantum
      uses: cuda-actions/setup-cuda@v1
      with:
        cuda-version: '12.5.0'

    - name: Install Python dependencies
      run: |
        python3 -m pip install --upgrade pip
        pip3 install cuda-quantum pytest numpy

    - name: Build C++ components
      run: |
        mkdir build && cd build
        cmake ..
        make -j$(nproc)

    - name: Run quantum-classical tests
      run: |
        cd tests
        python3 -m pytest quantum_integration.py --verbose

    - name: Performance validation
      run: |
        ./build/quantum_benchmark --iterations=100